---
title: Smallweb 0.12 - Publish and install flow for smallweb apps
author: Achille Lacoin
date: 2024-07-23
draft: true
tags:
  - release
---

Smallweb 0.12 is out! And it's the first release since 0.8 where I do not feel the need to fondamentally change the routing system ðŸ˜….

But this is still a big release! And it even contains a few breaking changes (don't worry, they are easy to fix).

## `smallweb install`: A new convention to install and publish smallweb apps

Smallweb now includes a new `smallweb install` command to install smallweb apps from the web.

Smallweb apps work on top of github repositories. When you run `smallweb install pomdtr/example-app ~/localhost/smallweb-app`, smallweb will clone the `pomdtr/example-app` repository in the `~/localhost/smallweb-app` folder.

<!-- more -->

If the repository contains a `smallweb` branch, smallweb will checkout this branch. Otherwise, it will checkout the `main` branch. This allows you to have a build step in your repository, whose output is stored in the `smallweb` branch.

This convention is really similar to how github pages work, and you can even repurposes github pages actions to build your smallweb app (see how this blog is built for an example).

A list of applications to install can be found at <https://apps.smallweb.run> (the domain may change in the future). You can add your own app to this list by add a `smallweb-app` topic to your github repository.

Once an app is installed, you can use the `git` cli to manage them. For example, you can run `git pull` to update the app to the latest version, or `git checkout <hash>` to rollback to a previous version. Take a look to the [pomdtr/smallweb-puller repository](https://github.com/pomdtr/smallweb-puller) for a simple way to trigger an app update from the ouside.

## `smallweb init` now support custom templates

The `smallweb init` was reworked to allow users to define custom templates from github. Just add a `smallweb-template` topic to your repository for it to appear in <https://templates.smallweb.run> (the domain may change in the future).

The new command usage is:

```ts
smallweb init [dir] [--template <repo>]
```

## Crons now uses http requests

Crons uses to be defined as shell commands:

```json
{
    "crons": [
        {
            "schedule": "0 0 * * *",
            "command": "deno",
            "args": ["run", "--allow-net", "https://example.com/cron.ts"]
        }
    ]
}
```

This had a few limitations:

- crons did not respect the permissions of the app
- getting access to the same Deno KV instance was tricky in some cases

For these reasons (and in preparation for the upcoming hosted version of smallweb), crons are now defined as HTTP requests:

```json
// smallweb.json
{
    "crons": [
        {
            "schedule": "0 0 * * *",
            "path": "/refresh",
        }
    ]
}
```

This is the exact same API as [Vercel's cron](https://vercel.com/guides/how-to-setup-cron-jobs-on-vercel), so you can refer to their documentation for some examples of how to use it.

This also remove the need for the `smallweb cron trigger` command (as you can just go to `https://<app>/refresh` to trigger the cron).

`smallweb cron list` was moved to `smallweb crons`.

## `smallweb open` new flags

Smallweb open now supports opening both using the app name or dir:

```sh
# open the react.localhost app
smallweb open --app react.localhost
# open the located at ~/localhost/react
smallweb open --dir ~/localhost/react
# open the current directory
smallweb open
```

## Smallweb REST API

There is a new API to interact with the smallweb ecosystem, available at <https://api.smallweb.run>. Currently it only supports listing apps, versions and templates.

Feel free to use it in your own projects, and let me know if you think of more endpoints that could be useful.

## What's next?

I really feel smallweb is in a good state right now, and I want to grow it's community. I have bought a new mike and as I plan to record some videos to showcase smallweb features on Youtube and Twitter.

Improved logs are still a priority. I want to move logs to their own file instead of using stderr/stdout, and allow you to filter them by app/time by storing them as JSON lines.

Now that I have an efficient way to distribute and install apps, I plan to work on populating the library of apps and templates.

I also want to work on a co
